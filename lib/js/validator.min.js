(function(){var a;a=function(){function a(){this.core=new window.OmiseValidation.validation,this.rules={ccName:new window.OmiseValidation.ccname,ccNumber:new window.OmiseValidation.ccnumber,ccExpiry:new window.OmiseValidation.ccexpiry,ccExpiryMonth:new window.OmiseValidation.ccexpirymonth,ccExpiryYear:new window.OmiseValidation.ccexpiryyear,ccSecurityCode:new window.OmiseValidation.ccsecuritycode},this.form={form:null,fields:[]}}return a.prototype.validates=function(a,b,c){return null==c&&(c=null),"string"==typeof a&&"string"==typeof b?this.form.fields.push({target:a,validates:"string"==typeof b?[b]:b,selector:null,callback:c}):void 0},a.prototype.validateCcName=function(a,b){return null==b&&(b=null),this.validates(a,"ccName",b)},a.prototype.validateCcNumber=function(a,b){return null==b&&(b=null),this.validates(a,"ccNumber",b)},a.prototype.validateCcExpiry=function(a,b){return null==b&&(b=null),this.validates(a,"ccExpiry",b)},a.prototype.validateCcExpiryMonth=function(a,b){return null==b&&(b=null),this.validates(a,"ccExpiryMonth",b)},a.prototype.validateCcExpiryYear=function(a,b){return null==b&&(b=null),this.validates(a,"ccExpiryYear",b)},a.prototype.validateCcSecurityCode=function(a,b){return null==b&&(b=null),this.validates(a,"ccSecurityCode",b)},a.prototype.validate=function(){var a,b,c,d,e,f;for(f=!0,d=this.form.fields,b=0,c=d.length;c>b;b++)a=d[b],a.selector.dataset.dirty=!0,(e=a.validates.validate(a.selector.value))!==!0&&(f=!1),this.core.response.result(null,a,e);return f},a.prototype.attachForm=function(a,b,c){var d,e,f,g,h;if(null==a&&(a=null),null==b&&(b=null),null==c&&(c=null),null!=a){if(this.form.form=this._manipulateSelectors(a),null==this.form.form)return!1;for(g=this.form.fields.reverse(),e=f=g.length-1;f>=0;e=f+=-1)d=g[e],null==d.selector&&(h=function(a){return function(b){return b.selector=a._manipulateSelectors(b.target),null==b.selector?!1:(b.validates=a.rules[b.validates[0]]||!1,b.validates===!1?!1:(a._initValidateField(b.selector,b.target),a._observeField(b)))}}(this)(d),h===!1?this.form.fields.splice(e,1):this.form.fields[e]=d);this._observeForm(this.form,b,c)}},a.prototype._manipulateSelectors=function(a){switch(a[0]){case"#":return document.getElementById(a.substring(1));case".":return document.getElementsByClassName(a.substring(1))[0];default:return document.getElementById(a)}},a.prototype._initValidateField=function(a,b){var c,d,e;return/^[.#]/.test(b)&&(b=b.substring(1)),c=document.getElementsByClassName(b+"_wrapper"),c=c.length>0?c.length:"",e=document.createElement("span"),e.id=""+b+c+"_wrapper",e.className="omise_validation_wrapper",a.parentNode.replaceChild(e,a),e.appendChild(a),d=document.createElement("span"),d.id=""+b+c+"_validation_msg",d.className="omise_validation_msg",e.appendChild(d),a.dataset.dirty=!1,a.dataset.wrapper=e.id,a.dataset.validationMsg=d.id},a.prototype._observeForm=function(a,b,c){return null==b&&(b=null),null==c&&(c=null),this.core.observeForm(a,b,c)},a.prototype._observeField=function(a){return this.core.observeField(a)},a}(),window.OmiseValidation={},window.OmiseValidator=a}).call(this),function(){var a;a=function(){function a(){}return a.prototype.pushMessage=function(a,b){var c;return c=a.dataset.validationMsg,c=document.getElementById(c),null!=c?c.innerHTML=b:void 0},a.prototype.invalid=function(a,b){var c;return c=document.getElementById(a.dataset.wrapper),c.className=c.className.replace(/\ valid/,""),/ invalid/.test(c.className)===!1&&(c.className+=" invalid"),this.pushMessage(a,b)},a.prototype.valid=function(a){var b;return b=document.getElementById(a.dataset.wrapper),b.className=b.className.replace(/\ invalid/,""),/ valid/.test(b.className)===!1&&(b.className+=" valid"),this.pushMessage(a,"")},a.prototype.result=function(a,b,c){return c!==!0?"function"==typeof b.callback?b.callback(a,b,c):c===!1?!1:this.invalid(b.selector,c):this.valid(b.selector)},a}(),window.OmiseValidation.response=a}.call(this),function(){var a;a=function(){function a(){}return a.prototype.isEmpty=function(a){return a.length<=0},a.prototype.isDigit=function(a){return/^\d+$/.test(a)},a.prototype.isAlphabet=function(a){return/^[a-z\.]+$/gi.test(a)},a.prototype.isExpiry=function(a){return/^(0[1-9]|1[0-2]) \/ ([0-9]{2}|[0-9]{4})$/.test(a)},a.prototype.isExpiryYear=function(a){return/^([0-9]{2}|[0-9]{4})$/.test(a)},a.prototype.isExpiryMonth=function(a){return/^(0[1-9]|1[0-2])$/.test(a)},a.prototype.isCard=function(a,b){var c,d,e;switch(c=/^(?:2131|1800|35\d{3})\d{11}$/,e=/^(?:4[0-9]{12}(?:[0-9]{3})?)$/,d=/^(?:5[1-5][0-9]{14})$/,a){case"jcb":return c.test(b);case"visa":return e.test(b);case"mastercard":return d.test(b);default:return!1}},a}(),window.OmiseValidation.rules=a}.call(this),function(){var a;a=function(){function a(){this.messages={emptyString:"The value must not be an empty",alphabetOnly:"The value must be a alphabet character only",digitOnly:"The value must be a digit character only",nameEmpty:"Name on card cannot be empty",nameAlphabet:"Name on card must only contains letters",cardEmpty:"Card number cannot be empty",cardFormat:"Card number is invalid",cardNotMatch:"Card number is invalid",expiryEmpty:"Expiration cannot be empty",expiryFormat:"Expiration is invalid",securitycodeMin:"Code must be greater or equal to 3 characters",securitycodeMax:"Code must be less or equal to 4 characters"}}return a.prototype.get=function(a){return this.messages[a]||"invalid"},a}(),window.OmiseValidation.messages=a}.call(this),function(){var a;a=function(){function a(){this.rule=new window.OmiseValidation.rules,this.helper=new window.OmiseValidation.helper,this.message=new window.OmiseValidation.messages,this.response=new window.OmiseValidation.response}return a.prototype.observeForm=function(a,b,c){return null==b&&(b=null),null==c&&(c=null),a.form.addEventListener("submit",function(d){return function(e){var f,g,h,i,j,k;for(e.preventDefault(),h=!1,j=a.fields,g=0,i=j.length;i>g;g++)f=j[g],f.selector.dataset.dirty=!0,(k=f.validates.validate(f.selector.value))!==!0&&(h=!0),d.response.result(e,f,k);return h===!1?"function"==typeof c?c(a):a.form.submit():"function"==typeof b?b(a):void 0}}(this),!1)},a.prototype.observeField=function(a){var b;return"function"==typeof(b=a.validates).init&&b.init(a,{_validates:this.rule,_helper:this.helper,_message:this.message,_response:this.response}),a.selector.onkeydown=function(b){return function(c){return b._onkeydownEvent(c,a)}}(this),a.selector.onkeypress=function(b){return function(c){return b._onkeypressEvent(c,a)}}(this),a.selector.onkeyup=function(b){return function(c){return b._onkeyupEvent(c,a)}}(this),a.selector.onpaste=function(b){return function(c){return b._onpasteEvent(c,a)}}(this),a.selector.onblur=function(b){return function(c){return b._onblurEvent(c,a)}}(this)},a.prototype._onkeydownEvent=function(a,b){var c;return a=a||window.event,a.which=a.which||a.keyCode||0,"function"==typeof(c=b.validates).onkeydownEvent?c.onkeydownEvent(a,b):void 0},a.prototype._onkeypressEvent=function(a,b){var c;return a=a||window.event,a.which=a.which||a.keyCode||0,"function"==typeof(c=b.validates).onkeypressEvent?c.onkeypressEvent(a,b):void 0},a.prototype._onkeyupEvent=function(a,b){var c;return a=a||window.event,a.which=a.which||a.keyCode||0,"function"==typeof(c=b.validates).onkeyupEvent?c.onkeyupEvent(a,b):void 0},a.prototype._onpasteEvent=function(a,b){var c;return a=a||window.event,a.which=a.which||a.keyCode||0,"function"==typeof(c=b.validates).onpasteEvent?c.onpasteEvent(a,b):void 0},a.prototype._onblurEvent=function(a,b){var c;return a=a||window.event,a.which=a.which||a.keyCode||0,"function"==typeof(c=b.validates).onblurEvent?c.onblurEvent(a,b):void 0},a}(),window.OmiseValidation.validation=a}.call(this),function(){var a;a=function(){function a(){}return a.prototype.delValFromCaretPosition=function(a,b){var c;return null==b&&(b=1),(c=a.selectionStart-b)>=0?a.value=a.value.slice(0,c)+a.value.slice(c+b):a.value="",a.focus(),a.setSelectionRange(c,c),c},a.prototype.insertValAfterCaretPos=function(a,b,c){var d;return c!==a.length?(d=a.split(""),d.splice(c,0,b),d=d.join(""),d=d.match(/\d/g),d=d.join("")):d=""+a+b,d},a.prototype.getCaretPosition=function(a){return a.selectionStart},a.prototype.setCaretPosition=function(a,b){return a.focus(),a.setSelectionRange(b,b)},a.prototype.beDirty=function(a){return a.dataset.dirty=!0},a.prototype.dirty=function(a){return"true"===a.dataset.dirty?!0:!1},a.prototype.isMetaKey=function(a){return a.metaKey===!1&&a.ctrlKey===!1&&a.altKey===!1&&"ShiftLeft"!==a.code&&"ShiftRight"!==a.code&&"Shift"!==a.keyIdentifier?!1:!0},a.prototype.inputChar=function(a){var b;return null!=a.keyIdentifier?(b=parseInt(a.keyIdentifier.substr(2),16),b=String.fromCharCode(b)):b=a.key,b},a.prototype.caretRange=function(a){var b,c,d;return c=this.getCaretRange(a),d=c.start,b=c.end,a.value.substring(d,b)},a.prototype.getCaretRange=function(a){var b,c,d;return null!=a.createTextRange?(c=document.selection.createRange().duplicate(),c.moveEnd("character",a.value.length),d=""===c.text?a.value.length:a.value.lastIndexOf(d.text),c.moveStart("character",-a.value.length),b=c.text.length):(d=a.selectionStart,b=a.selectionEnd),{start:d,end:b}},a}(),window.OmiseValidation.helper=a}.call(this),function(){var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(){this.onblurEvent=b(this.onblurEvent,this),this.onpasteEvent=b(this.onpasteEvent,this),this.onkeyupEvent=b(this.onkeyupEvent,this),this.onkeydownEvent=b(this.onkeydownEvent,this),this.strLimit=6,this.pattern="## / ####",this.format=/^(0[1-9]|1[0-2]) \/ ([0-9]{2}|[0-9]{4})$/}return a.prototype.init=function(a,b){return this.validates=b._validates,this.helper=b._helper,this.message=b._message,this.response=b._response},a.prototype._format=function(a,b,c){var d;return null==a&&(a=""),null==b&&(b=""),null==c&&(c=null),0===a.length&&/^[2-9]+$/.test(b)?d="0"+b:c!==a.length?(d=a.split(""),d.splice(c,0,b),d=d.join(""),d=d.match(/\d/g),d=d.join("")):d=""+a+b,this._reFormat(d)},a.prototype._reFormat=function(a){var b,c,d,e,f,g,h;if(null==a&&(a=""),0===a.length)return a;for(a=a.match(/\d/g),a=null!=a?a.join(""):void 0,c="",b=0,h=this.pattern,e=f=0,g=h.length;g>f;e=++f)if(d=h[e],"#"===d){if(!(b<a.length))break;c+=a[b],b+=1}else c+=d;return c},a.prototype._reFormatExpiryPattern=function(a,b){var c,d,e,f,g,h,i,j,k;if(null==a&&(a=""),0===a.length)return a;for(a=a.match(/\d/g),a=null!=a?a.join(""):void 0,e="",d=0,c=0,k=this.pattern,h=i=0,j=k.length;j>i;h=++i)if(g=k[h],c+=1,"#"===g){if(!(d<a.length))break;e+=a[d],d+=1}else e+=g;return f=b.target.selectionStart,b.target.value=e,this.helper.setCaretPosition(b.target,f+(e.length-f)),e},a.prototype.validate=function(a,b){return null==b&&(b=null),this.validates.isEmpty(a)?this.message.get("expiryEmpty"):this.validates.isExpiry(a)?!0:this.message.get("expiryFormat")},a.prototype._preventCharacter=function(a,b){return a=a.replace(/\ \/\ /g,""),this.validates.isDigit(a)?a.length>this.strLimit?!1:!0:!1},a.prototype._preventInput=function(a,b,c){var d,e,f,g;return this.validates.isDigit(a)?(d=c.target.selectionStart,""!==(g=this.helper.caretRange(c.target))?(e=b.slice(0,d),f=b.slice(d+g.length),b=e+a+f):b=this.helper.insertValAfterCaretPos(b,a,d),b=b.match(/\d/g),b=null!=b?b.join(""):void 0,b.length>this.strLimit?!1:b):!1},a.prototype.onkeydownEvent=function(a,b){var c,d,e,f,g,h;if(this.helper.isMetaKey(a)===!1){if(null===(g=a.which)||0===g||9===g||13===g||20===g||27===g||37===g||38===g||39===g||40===g)return!0;if(8===a.which){if(a.preventDefault(),0!==(f=this.helper.getCaretPosition(a.target))){switch(c=a.target.value[f-1],f-1){case 4:case 3:case 2:f=this.helper.delValFromCaretPosition(a.target,f-1);break;default:f=this.helper.delValFromCaretPosition(a.target)}a.target.value=this._reFormat(a.target.value),this.helper.setCaretPosition(a.target,f)}if("true"===this.helper.dirty(a.target))return this.response.result(a,b,this.validate(a.target.value))}else{if(e=this.helper.inputChar(a),h=a.target.value,d=a.target.selectionStart,0===h.length&&/^[2-9]+$/.test(e)?(e="0"+e,d+=2):1===d&&(d+=1),!(h=this._preventInput(e,h,a)))return!1;if(a.preventDefault(),this._reFormatExpiryPattern(h,a),this.helper.dirty(a.target))return this.response.result(a,b,this.validate(a.target.value))}}},a.prototype.onkeyupEvent=function(a,b){return this.helper.dirty(a.target)?this.response.result(a,b,this.validate(a.target.value)):void 0},a.prototype.onpasteEvent=function(a,b){var c,d;return c=a.clipboardData.getData("text/plain"),d=a.target.value,(d=this._preventInput(c,d,a))?(a.preventDefault(),this._reFormatExpiryPattern(d,a),this.helper.beDirty(a.target)):!1},a.prototype.onblurEvent=function(a,b){return a.target.value.length>0&&this.helper.beDirty(a.target),this.helper.dirty(a.target)?this.response.result(a,b,this.validate(a.target.value)):void 0},a}(),window.OmiseValidation.ccexpiry=a}.call(this),function(){var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(){this.onblurEvent=b(this.onblurEvent,this),this.onpasteEvent=b(this.onpasteEvent,this),this.onkeyupEvent=b(this.onkeyupEvent,this),this.onkeydownEvent=b(this.onkeydownEvent,this),this.strLimit=2}return a.prototype.init=function(a,b){return this.validates=b._validates,this.helper=b._helper,this.message=b._message,this.response=b._response},a.prototype.validate=function(a,b){return null==b&&(b=null),this.validates.isEmpty(a)?this.message.get("expiryEmpty"):this.validates.isDigit(a)?this.validates.isExpiryMonth(a)?!0:this.message.get("expiryFormat"):this.message.get("digitOnly")},a.prototype._preventInput=function(a,b,c){var d,e,f,g;return this.validates.isDigit(a)?(d=c.target.selectionStart,""!==(g=this.helper.caretRange(c.target))?(e=b.slice(0,d),f=b.slice(d+g.length),b=e+a+f):b=this.helper.insertValAfterCaretPos(b,a,d),b.length>this.strLimit?!1:b):!1},a.prototype.onkeydownEvent=function(a,b){var c,d,e;if(this.helper.isMetaKey(a)===!1){if(null===(d=a.which)||0===d||9===d||13===d||20===d||27===d||37===d||38===d||39===d||40===d)return!0;if(8!==a.which){if(c=this.helper.inputChar(a),e=a.target.value,!this._preventInput(c,e,a))return!1;if(0===e.length&&/^[2-9]+$/.test(c))return a.preventDefault(),e="0"+c,a.target.value=e}}},a.prototype.onkeyupEvent=function(a,b){return this.helper.dirty(a.target)?this.response.result(a,b,this.validate(a.target.value)):void 0},a.prototype.onpasteEvent=function(a,b){var c,d;return c=a.clipboardData.getData("text/plain"),d=a.target.value,(d=this._preventInput(c,d,a))?(this.helper.beDirty(a.target),this.response.result(a,b,this.validate(d))):!1},a.prototype.onblurEvent=function(a,b){return a.target.value.length>0&&this.helper.beDirty(a.target),this.helper.dirty(a.target)?this.response.result(a,b,this.validate(a.target.value)):void 0},a}(),window.OmiseValidation.ccexpirymonth=a}.call(this),function(){var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(){this.onblurEvent=b(this.onblurEvent,this),this.onpasteEvent=b(this.onpasteEvent,this),this.onkeyupEvent=b(this.onkeyupEvent,this),this.onkeydownEvent=b(this.onkeydownEvent,this),this.strLimit=4}return a.prototype.init=function(a,b){return this.validates=b._validates,this.helper=b._helper,this.message=b._message,this.response=b._response},a.prototype.validate=function(a,b){return null==b&&(b=null),this.validates.isEmpty(a)?this.message.get("expiryEmpty"):this.validates.isDigit(a)?this.validates.isExpiryYear(a)?!0:this.message.get("expiryFormat"):this.message.get("digitOnly")},a.prototype._preventInput=function(a,b,c){var d,e,f,g;return this.validates.isDigit(a)?(d=c.target.selectionStart,""!==(g=this.helper.caretRange(c.target))?(e=b.slice(0,d),f=b.slice(d+g.length),b=e+a+f):b=this.helper.insertValAfterCaretPos(b,a,d),b.length>this.strLimit?!1:b):!1},a.prototype.onkeydownEvent=function(a,b){var c,d,e;if(this.helper.isMetaKey(a)===!1){if(null===(d=a.which)||0===d||9===d||13===d||20===d||27===d||37===d||38===d||39===d||40===d)return!0;if(8!==a.which&&(c=this.helper.inputChar(a),e=a.target.value,!this._preventInput(c,e,a)))return!1}},a.prototype.onkeyupEvent=function(a,b){return this.helper.dirty(a.target)?this.response.result(a,b,this.validate(a.target.value)):void 0},a.prototype.onpasteEvent=function(a,b){var c,d;return c=a.clipboardData.getData("text/plain"),d=a.target.value,(d=this._preventInput(c,d,a))?(this.helper.beDirty(a.target),this.response.result(a,b,this.validate(d))):!1},a.prototype.onblurEvent=function(a,b){return a.target.value.length>0&&this.helper.beDirty(a.target),this.helper.dirty(a.target)?this.response.result(a,b,this.validate(a.target.value)):void 0},a}(),window.OmiseValidation.ccexpiryyear=a}.call(this),function(){var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(){this.onblurEvent=b(this.onblurEvent,this),this.onpasteEvent=b(this.onpasteEvent,this),this.onkeyupEvent=b(this.onkeyupEvent,this),this.onkeydownEvent=b(this.onkeydownEvent,this)}return a.prototype.init=function(a,b){return this.validates=b._validates,this.helper=b._helper,this.message=b._message,this.response=b._response},a.prototype.validate=function(a,b){return null==b&&(b=null),a=a.replace(/\s/g,""),this.validates.isEmpty(a)?this.message.get("nameEmpty"):this.validates.isAlphabet(a)?!0:this.message.get("nameAlphabet")},a.prototype.onkeydownEvent=function(a,b){var c;if(this.helper.isMetaKey(a)===!1){if(null===(c=a.which)||0===c||9===c||20===c||27===c||37===c||38===c||39===c||40===c)return!0;if(8!==a.which)return this.helper.beDirty(a.target)}},a.prototype.onkeyupEvent=function(a,b){return this.helper.dirty(a.target)?this.response.result(a,b,this.validate(a.target.value)):void 0},a.prototype.onpasteEvent=function(a,b){var c,d;return c=a.clipboardData.getData("text/plain"),d=a.target.value,this.helper.beDirty(a.target),this.response.result(a,b,this.validate(d+c))},a.prototype.onblurEvent=function(a,b){return a.target.value.length>0&&this.helper.beDirty(a.target),this.helper.dirty(a.target)?this.response.result(a,b,this.validate(a.target.value)):void 0},a}(),window.OmiseValidation.ccname=a}.call(this),function(){var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(){this.onblurEvent=b(this.onblurEvent,this),this.onpasteEvent=b(this.onpasteEvent,this),this.onkeyupEvent=b(this.onkeyupEvent,this),this.onkeydownEvent=b(this.onkeydownEvent,this),this.init=b(this.init,this),this.cards=[{type:"mastercard",pattern:/^5[1-5]/,format:"#### #### #### ####",length:[16],icon:"http://cdn.omise.co/validator/images/icon-mastercard.png",validate:/(?:^|\s)(\d{4})$/},{type:"visa",pattern:/^4/,format:"#### #### #### ####",length:[13,16],icon:"http://cdn.omise.co/validator/images/icon-visa.png",validate:/(?:^|\s)(\d{4})$/},{type:"jcb",pattern:/^(?:^|\s)(?:2131|1800|35\d{3})/,format:"#### #### #### ####",length:[15,16],icon:"http://cdn.omise.co/validator/images/icon-jcb.png",validate:/(?:^|\s)(\d{4})$/}],this.cardUnknow={type:"unknow",format:"#### #### #### ####",length:[16]}}return a.prototype.init=function(a,b){return this.validates=b._validates,this.helper=b._helper,this.message=b._message,this.response=b._response,this._appendCcIcon(a.selector)},a.prototype._appendCcIcon=function(a){var b,c,d,e,f,g,h,i,j;for(g=a.parentNode,j=document.createElement("span"),j.id="omise_card_brand_supported",g.appendChild(j),h=this.cards,i=[],d=e=0,f=h.length;f>e;d=++e)b=h[d],c=document.createElement("img"),c.src=b.icon,c.className="omise_ccnumber_card omise_ccnumber_"+b.type,i.push(j.appendChild(c));return i},a.prototype._show=function(a,b){var c,d;return this._hide(a),c="omise_ccnumber_"+b.type,d=a.parentNode.getElementsByClassName(c),0!==d.length?(d=d[0],d.className=d.className+" match"):void 0},a.prototype._hide=function(a){var b,c,d,e,f;for(c=a.parentNode.getElementsByClassName("omise_ccnumber_card"),f=[],d=0,e=c.length;e>d;d++)b=c[d],f.push(b.className=b.className.replace(/\ match/gi,""));return f},a.prototype._validateCardPattern=function(a){var b,c,d,e;for(a=(a+"").replace(/\D/g,""),e=this.cards,c=0,d=e.length;d>c;c++)if(b=e[c],b.pattern.test(a)===!0)return b},a.prototype._reFormatCardPattern=function(a,b){var c,d,e,f,g,h,i;if(null==a&&(a=""),0===a.length)return a;for(a=a.match(/\d/g),a=null!=a?a.join(""):void 0,i="",g=0,h=b.format,d=e=0,f=h.length;f>e;d=++e)if(c=h[d],"#"===c){if(!(g<a.length))break;i+=a[g],g+=1}else i+=c;return i},a.prototype.validate=function(a,b){var c;return null==b&&(b=""),a=(a+"").replace(/\D/g,""),this.validates.isEmpty(a)?this.message.get("cardEmpty"):(c=this._validateCardPattern(a),null==c?this.message.get("cardNotMatch"):this.validates.isCard(c.type,a)?!0:this.message.get("cardFormat"))},a.prototype._preventInput=function(a,b,c){return a=(a+"").replace(/\s/g,""),this.validates.isDigit(a)?!0:!1},a.prototype.onkeydownEvent=function(a,b){var c,d,e,f,g,h,i,j,k,l,m;if(this.helper.isMetaKey(a)===!1){if(null===(k=a.which)||0===k||9===k||13===k||20===k||27===k||37===k||38===k||39===k||40===k)return!0;if(8===a.which)""!==(j=this.helper.caretRange(a.target))?(i=a.target.selectionStart,g=a.target.value.slice(0,i),h=a.target.value.slice(i+j.length),c=g+h,a.target.value=c):0!==(i=this.helper.getCaretPosition(a.target))&&(i=/\s/.test(a.target.value[i-1])?this.helper.delValFromCaretPosition(a.target,2):this.helper.delValFromCaretPosition(a.target)),e=this._validateCardPattern(a.target.value)||this.cardUnknow,"unknow"===e.type?this._hide(a.target):this._show(a.target,e),a.preventDefault(),a.target.value=this._reFormatCardPattern(a.target.value,e),this.helper.setCaretPosition(a.target,i);else{if(f=this.helper.inputChar(a),m=a.target.value,!this._preventInput(f,m,a))return!1;if(""!==(j=this.helper.caretRange(a.target))&&j.length===m.length)return!0;if(d=a.target.selectionStart,l=this.helper.insertValAfterCaretPos(m,f,d),l=(l+"").replace(/\D/g,""),e=this._validateCardPattern(l)||this.cardUnknow,"unknow"===e.type?this._hide(a.target):this._show(a.target,e),l.length>e.length[e.length.length-1])return!1;l=this._reFormatCardPattern(l,e),a.preventDefault(),a.target.value=l,d+=1," "===l.charAt(d)?d+=1:" "===l.charAt(d-1)&&(d+=1),this.helper.setCaretPosition(a.target,d)}if(this.helper.dirty(a.target))return this.response.result(a,b,this.validate(a.target.value))}},a.prototype.onkeyupEvent=function(a,b){var c,d;return d=(a.target.value+"").replace(/\D/g,""),c=this._validateCardPattern(d)||this.cardUnknow,"unknow"===c.type?this._hide(a.target):this._show(a.target,c),this.helper.dirty(a.target)?this.response.result(a,b,this.validate(a.target.value)):void 0},a.prototype.onpasteEvent=function(a,b){var c,d,e,f,g,h,i,j;return e=a.clipboardData.getData("text/plain"),j=a.target.value,this._preventInput(e,j,a)?(h=this.helper.getCaretRange(a.target),h.start===h.end?(c=a.target.selectionStart,i=this.helper.insertValAfterCaretPos(j,e,c),i=(i+"").replace(/\D/g,"")):(c=a.target.selectionStart,0===h.start&&h.end===j.length?(c=h.start,i=e,j=""):(f=a.target.value.slice(0,h.start),g=a.target.value.slice(h.end),i=f+e+g,j=f+g)),i=(i+"").replace(/\D/g,""),d=this._validateCardPattern(i)||this.cardUnknow,"unknow"===d.type?this._hide(a.target):this._show(a.target,d),i.length>d.length[d.length.length-1]?!1:(i=this._reFormatCardPattern(i,d),c+=Math.abs(i.length-j.length),/ $/.test(j)&&(c+=1),a.preventDefault(),a.target.value=i,this.helper.setCaretPosition(a.target,c),this.helper.beDirty(a.target),this.response.result(a,b,this.validate(j+e)))):!1},a.prototype.onblurEvent=function(a,b){return a.target.value.length>0&&this.helper.beDirty(a.target),this.helper.dirty(a.target)?this.response.result(a,b,this.validate(a.target.value)):void 0},a}(),window.OmiseValidation.ccnumber=a}.call(this),function(){var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(){this.onblurEvent=b(this.onblurEvent,this),this.onpasteEvent=b(this.onpasteEvent,this),this.onkeyupEvent=b(this.onkeyupEvent,this),this.onkeydownEvent=b(this.onkeydownEvent,this),this.strMin=3,this.strLimit=4}return a.prototype.init=function(a,b){return this.validates=b._validates,this.helper=b._helper,this.message=b._message,this.response=b._response},a.prototype.validate=function(a,b){return null==b&&(b=null),this.validates.isEmpty(a)?this.message.get("emptyString"):this.validates.isDigit(a)?a.length<this.strMin?this.message.get("securitycodeMin"):a.length>this.strLimit?this.message.get("securitycodeMax"):!0:this.message.get("digitOnly")},a.prototype._preventInput=function(a,b,c){var d,e,f,g;return this.validates.isDigit(a)?(d=c.target.selectionStart,""!==(g=this.helper.caretRange(c.target))?(e=b.slice(0,d),f=b.slice(d+g.length),b=e+a+f):b=this.helper.insertValAfterCaretPos(b,a,d),b.length>this.strLimit?!1:b):!1},a.prototype.onkeydownEvent=function(a,b){var c,d,e;if(this.helper.isMetaKey(a)===!1){if(null===(d=a.which)||0===d||9===d||13===d||20===d||27===d||37===d||38===d||39===d||40===d)return!0;if(8!==a.which&&(c=this.helper.inputChar(a),e=a.target.value,!this._preventInput(c,e,a)))return!1}},a.prototype.onkeyupEvent=function(a,b){return this.helper.dirty(a.target)?this.response.result(a,b,this.validate(a.target.value)):void 0},a.prototype.onpasteEvent=function(a,b){var c,d;return c=a.clipboardData.getData("text/plain"),d=a.target.value,(d=this._preventInput(c,d,a))?this.helper.beDirty(a.target):!1},a.prototype.onblurEvent=function(a,b){return a.target.value.length>0&&this.helper.beDirty(a.target),this.helper.dirty(a.target)?this.response.result(a,b,this.validate(a.target.value)):void 0},a}(),window.OmiseValidation.ccsecuritycode=a}.call(this);